inherit_from: configs/SimuEvent/simu_event.yaml
dataset: 'replica_simu_event'

# iteration number
num_opti_steps_for_depthEst_init: 6001
num_opti_steps_for_init: 6001
num_opti_steps_for_tracking: 401
num_opti_steps_for_BA: 1501
num_opti_steps_for_global_BA: 4501
num_opti_steps_for_final_global_BA: 4501

num_events_window_for_init: 300000
num_events_window_for_tracking: 100000
num_events_window_for_BA: 300000
num_events_window_for_BA_random: 300000
pose_lr: 0.0001
sliding_window_sz: 20
is_color: False

use_linLog: True
save_model: True
visualize_inter_img_in_Tracking_BA: True
num_intra_chunk_BAsampling_idx_batch: 4 # 1 ~ (sliding_window_sz-1)
num_inter_chunk_BAsampling_idx_batch: 0
num_con_inter_chunk_BAsampling_idx_batch: 0
num_inter_chunk_initSampling_idx_batch: 0
num_events_to_skip: 0 
ctrl_knot_step: 1
tracking_batch_size: 1
traj_mode_BA: linear # cspline or linear
start_cspline_idx: 5
use_uncertainty_in_BA: False
BA_every_track: 2  # track BA_every_track times and perform one BA
render_eventview_img: True
# 0: use absolute pose; 1: use relative pose from individual frame;  2: fix the first pose and use relative pose from it
use_relative_pose_to_opt: 0
use_mask_event_loss: True

# depth estimation
depth_estimation_init: 0 #0: don't use depth; 1: estimate depth during initialization; 2: use pre-estimated depth
depthEst_pretrained_model_path: depthEst_pretrained_model/models--Bingxin--Marigold/snapshots/0f4e0021da7a153804301f8b988e8b7b4daf056b

only_track_event_area: False
use_gt_pose_to_opt: False
opt_pose: True
initOnly: False

evaluate_img: True
eval_start_idx: 1 # corresponds in original files, not data.training_start_index
eval_end_idx: 24
eval_step_size: 1

data:
  datadir: Z:\Datasets\inputs\synthetic\EMS_420
  scene: None
  output: Z:\Datasets\outputs\EMS_420
  exp_name: demo_room
  trainskip: 1
  downsample_factor: 1
  training_start_index: 0 # the size of training data depends on your computer memory size
  training_end_index: 25 # -1 for the last index
  interval_selection: 1

initialization:
  num_frames_for_init: 5 # use how many frames event data in the initial
  incre_sampling_seg_num_expected: 200
  min_n_winsize: 10000
  max_n_winsize: 30000
  training_batch_size: 1 #depends your GPU memory size
  visualize_every_iter: 100
  visualize_intermediate_img: True
  gaussian_init_sfm_mask: 0 # 0 for using depth map mask; 1 for using event map mask; 
  gaussian_num_sfm: 300000
  depth_path: Z:\Datasets\outputs\suzaku_slam\demo_room\Depth\depth_data.npy
  retain_pose: False

BA:
  incre_sampling_seg_num_expected: 200
  min_n_winsize: 10000
  max_n_winsize: 30000
  training_batch_size: 1 #depends your GPU memory size
  visualize_every_iter: 500
  visualize_intermediate_img: False
  global_BA_step: 25

mapping:
  bounding_size: 30 # very sensitive
  prune_opa: 0.1 # GSs with opacity below this value will be pruned
  refine_start_iter: 1000 # Start refining GSs after this iteration
  refine_every: 500 # Refine GSs every this steps
  refine_stop_iter: 5500 # Stop refining GSs after this iteration
  grow_grad2d: 0.000001
  grow_scale3d: 0.01
  prune_scale3d: 0.1
  prune_scale2d: 0.1
  blackness: 0.2

  color_channels: 1 # 1: grayscale; 3:RGB
  ssim_loss_factor_: 0.05
  loss_isotropic_weight: 0.0
  no_event_gaussian_cov: 0.0
  loss_rgb_weight: 0.0
  
  select_event_based_t: False
  select_ray_based_event: True
  first_iters: 10001
  lr_embed: 0.0005
  lr_decoder: 0.0005
  lr_rot: 0.0001
  lr_trans: 0.0001
  pose_lr: 0.0001
  cur_frame_iters: 200
  vis_cur_frame: False
  iters: 800
  init_frame_num: 6
  use_median_filter: False
  use_white_balance_loss: False
  white_balance_weight: 0.0
  background: 2

tracking:
  iter: 400
  pose_lr: 0.0005
  render_gt_img: True
  render_novel_views: False
 

event:
  threshold: 0.1

training:
  n_samples: 32
  n_importance: 32
  render_gt_img: False
  render_novel_views: True

visualization:
  num_rays_per_chunk: 1024
  render_img_init: True
  visualize_gt_event_img: False
  render_novel_views: False
  BA_render_novel_views: False
  BA_render_est_gt_pose_views: False

cam:
  H: 480
  W: 640
  fx: 354.09393311
  fy: 354.09393311
  #fy: 398.35567474
  cx: 320
  cy: 240
  png_depth_scale: False #for depth image in png format
  crop_edge: 0
  near: 0.0
  far: 1000
  depth_trunc: 0